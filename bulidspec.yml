version: 0.2
env:
  variables:
    REACT_APP_DEMO_VAR: 'cliimate-accelerator-testing'
phases:
  install:
    runtime-versions:
      nodejs: 16
    commands:
      - mkdir lambda_code
      - cd lambda_code
      - echo "Starting install - $(date)"
      - npm install
      - echo "Completed install - $(date)"
  build:
    commands:
      - cd lambda_code
      - echo "Starting build - $(date)"
      - npm run build
      - echo "Completed build - $(date)"
      - zip -r function.zip .
  post_build:
    commands:
      - echo "Updating lambda Function..."
      - aws lambda update-function-code --function-name codepipeline_ci-cd --zip-file fileb://function.zip
      - echo "DONE!!"